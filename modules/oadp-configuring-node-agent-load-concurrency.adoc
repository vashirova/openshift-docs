:_mod-docs-content-type: PROCEDURE
// Module included in the following assemblies:
//
// * backup_and_restore/application_backup_and_restore/installing/installing-oadp-aws.adoc


[id="oadp-configuring-node-agent-load-concurrency_{context}"]
= Configuring Node Agent Load Concurrency

[role="_abstract"]
You can control the maximum number of Data Mover operations that can run simultaneously on each node within your cluster. You can configure it using one of the following fields of the the Data Protection Application (DPA):

* `globalConfig`: Defines a default concurrency limit for the Node Agent across all nodes.
* `perNodeConfig`: Specifies different concurrency limits for specific nodes based on `nodeSelector` labels. This provides flexibility for environments where certain nodes might have different resource capacities or roles.


// .Prerequisites
// TBD - Are there any?

.Procedure

. If you want to use Load Concurrency for specific nodes, add labels to those nodes:
+
[source,terminal]
----
$ oc label node/<node_name> label.io/location='EU'
----

. Configure the Load Concurrency fields for your DPA instance:
+
[source,yaml]
----
  configuration:
    nodeAgent:
      enable: true
      loadConcurrency:
        globalConfig: 1 <1>
        perNodeConfig:
        - nodeSelector:
            matchExpressions:
            - key: label.io/location <2>
              operator: In
              values:
              - EU <3>
          number: 3 <4>
----
<1> Specify the `globalConfig` value. The default value is 1, which means there is no concurrency, only one load is allowed. The `globalConfig` value does not have a limit.
<2> Specify the `key` value that you used to add labels.
<3> Specify the values you used to add labels.
<4> Specify the `number` value for per-node concurrency. You can specify different concurrent number per node. For example, you can set 3 concurrent instances for EU and 2 instances for US. The range of per-node concurrent number is the same as the global concurrent number. If the configuration file contains a per-node concurrent number and a global concurrent number, the per-node concurrent number takes precedent.


// .Verification
// TBD - Do we need it?
